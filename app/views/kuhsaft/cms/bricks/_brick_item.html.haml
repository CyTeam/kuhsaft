.brick-item{ :id => brick.to_brick_item_id, :class => brick.to_style_class }
  = simple_form_for brick, :as => :brick, :url => kuhsaft.cms_brick_path(brick), :remote => true, :html => { :id => nil } do |form|
    - if brick.user_can_change_persisted?
      .brick-item-header.clearfix
        .pull-left
          - if brick.caption.present?
            = brick.caption
          %span.muted
            = brick.backend_label(:parenthesis => true)
        .pull-right
          .btn-group
            - # delete button
            - if brick.persisted?
              = link_to kuhsaft.cms_brick_path(brick), :class => 'btn btn-small btn-danger', :confirm => t('kuhsaft.cms.bricks.brick_item.confirm'), :method => :delete, :remote => true do
                %i.icon-trash.icon-white
            - # addable child dropdown menu
            - if brick.respond_to?(:user_can_add_childs?) && brick.user_can_add_childs? && Kuhsaft::BrickType.count > 0
              %a.btn.btn-small.dropdown-toggle{ 'data-toggle' => 'dropdown', 'href' => '#' }
                = t('.add_element')
                %span.caret
              %ul.dropdown-menu
                - Kuhsaft::BrickType.grouped.group_by(&:group).each do |group, types|
                  - types.each do |type|
                    %li
                      = link_to type.class_name.constantize.model_name.human, kuhsaft.cms_bricks_path(:brick => { :type => type.class_name, :brick_list_id => brick.id, :brick_list_type => brick.brick_list_type }), :remote => true, :method => :post
                  .divider

            - # save button
            = form.button :submit, :class => 'btn btn-success btn-small ', :value => t('.save')


    - brick_content = render(brick.to_edit_partial_path, :brick => brick, :form => form)
    - if brick_content.present?
      .brick-item-content
        = brick_content


  - if brick.renders_own_childs?
    .brick-item-childs
      = render brick.to_edit_childs_partial_path, :brick => brick
  - else
    - if brick.respond_to?(:bricks)
      .brick-item-childs
        = render 'kuhsaft/cms/bricks/brick_list', :brick_list => brick
